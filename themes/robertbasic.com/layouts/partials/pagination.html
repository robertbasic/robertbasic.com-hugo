<div class="navigation">
    {{ if .Paginator.HasPrev }}
        <a href="{{ .Paginator.First.URL }}"> &laquo; </a>
        <a href="{{ .Paginator.Prev.URL }}"> &lsaquo; </a>
    {{ end }}

    {{/* saving the current page number to a variable */}}
    {{/* because it is being overriden inside range's scope */}}
    {{ $currentPage := .Paginator.PageNumber }}
    {{ $endPages := sub .Paginator.TotalPages 2 }}
    {{ if lt $currentPage 4 }}
        {{ range first 5 .Paginator.Pagers }}
            {{ if eq $currentPage .PageNumber }}
            <a href="{{ .URL }}" class="current"> {{ .PageNumber }} </a>
            {{ else }}
            <a href="{{ .URL }}"> {{ .PageNumber }} </a>
            {{ end }}
        {{ end }}
    {{ else if gt $currentPage $endPages }}
        {{ range last 5 .Paginator.Pagers }}
            {{ if eq $currentPage .PageNumber }}
            <a href="{{ .URL }}" class="current"> {{ .PageNumber }} </a>
            {{ else }}
            <a href="{{ .URL }}"> {{ .PageNumber }} </a>
            {{ end }}
        {{ end }}
    {{ else }}
        {{ $lowerLimit := sub $currentPage 2 }}
        {{ $upperLimit := add $currentPage 2 }}
        {{ $pagesToRender := seq $lowerLimit $upperLimit }}
        {{ range .Paginator.Pagers }}
            {{ if eq $currentPage .PageNumber }}
            <a href="{{ .URL }}" class="current"> {{ .PageNumber }} </a>
            {{ else if in $pagesToRender .PageNumber }}
            <a href="{{ .URL }}"> {{ .PageNumber }} </a>
            {{ end }}
        {{ end }}
    {{ end }}

    {{ if .Paginator.HasNext }}
        <a href="{{ .Paginator.Next.URL }}"> &rsaquo; </a>
        <a href="{{ .Paginator.Last.URL }}"> &raquo; </a>
    {{ end }}
</div>
